/*!
*  musquito v1.0.0 
*  http://musquitojs.com
*
*  (c) 2018 Vijaya Anand
*  http://prideparrot.com
*
*  MIT License
*/
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.$buzz=t():e.$buzz=t()}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=7)}([function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(){i(this,e),this._navigator=null,this._contextType=null,this._formats={},this._isAudioEnabled=!1,"undefined"!=typeof navigator&&(this._navigator=navigator),"undefined"!=typeof AudioContext?this._contextType=AudioContext:"undefined"!=typeof webkitAudioContext&&(this._contextType=webkitAudioContext);var t=new Audio;this._formats={mp3:Boolean(t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:Boolean(t.canPlayType("audio/mpeg;").replace(/^no$/,"")),opus:Boolean(t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,"")),ogg:Boolean(t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")),oga:Boolean(t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")),wav:Boolean(t.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"")),aac:Boolean(t.canPlayType("audio/aac;").replace(/^no$/,"")),caf:Boolean(t.canPlayType("audio/x-caf;").replace(/^no$/,"")),m4a:Boolean((t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,"")),mp4:Boolean((t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,"")),weba:Boolean(t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:Boolean(t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:Boolean(t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,"")),flac:Boolean((t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,""))},t=null}return o(e,[{key:"id",value:function(){return Math.round(Date.now()*Math.random())}},{key:"getContextType",value:function(){return this._contextType}},{key:"getContext",value:function(){return new this._contextType}},{key:"supportedFormats",value:function(){return this._formats}},{key:"isFormatSupported",value:function(e){return Boolean(this._formats[e])}},{key:"getSupportedFormat",value:function(e){var t=this;return e.find(function(e){return t.isFormatSupported(e)})}},{key:"isSourceSupported",value:function(e){var t=this.isBase64(e)?/^data:audio\/([^;,]+);/i.exec(e):/^.+\.([^.]+)$/.exec(e);return t=/^.+\.([^.]+)$/.exec(e),!!t&&this.isFormatSupported(t[1].toLowerCase())}},{key:"getSupportedSource",value:function(e){var t=this;return e.find(function(e){return t.isSourceSupported(e)})}},{key:"isBase64",value:function(e){return/^data:[^;]+;base64,/.test(e)}},{key:"enableAudio",value:function(e){if((this._isMobile()||this._isTouch())&&!this._isAudioEnabled){var t=function t(){var n=e.createBufferSource();n.buffer=e.createBuffer(1,1,22050),n.connect(e.destination);var i=function e(){document.removeEventListener("touchend",t),n.disconnect(),n.removeEventListener("ended",e),n=null};n.addEventListener("ended",i),"undefined"==typeof n.start?n.noteOn(0):n.start(0)};document.addEventListener("touchend",t)}}},{key:"_isMobile",value:function(){return!!this._navigator&&/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi/i.test(this._navigator.userAgent)}},{key:"_isTouch",value:function(){return"undefined"!=typeof window&&Boolean("ontouchend"in window||this._navigator&&this._navigator.maxTouchPoints>0||this._navigator&&this._navigator.msMaxTouchPoints>0)}}]),e}();t.default=new r},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(){i(this,e),this._objectsEventsHandlersMap={}}return o(e,[{key:"on",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this._hasObject(e)||(this._objectsEventsHandlersMap[e]={});var o=this._objectsEventsHandlersMap[e];return o.hasOwnProperty(t)||(o[t]=[]),o[t].push({handler:n,once:i}),this}},{key:"off",value:function(e,t,n){if(!this._hasEvent(e,t))return this;var i=this._objectsEventsHandlersMap[e];return n?i[t]=i[t].filter(function(e){return e.handler!==n}):i[t]=[],this}},{key:"fire",value:function(e,t){for(var n=arguments.length,i=Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];if(!this._hasEvent(e,t))return this;for(var r=this._objectsEventsHandlersMap[e][t],u=0;u<r.length;u++){var s=r[u];setTimeout(function(n){var o=n.handler,r=n.once;o.apply(void 0,i),r&&this.off(e,t,o)}.bind(this,s),0)}return this}},{key:"clear",value:function(e){return e?(this._hasObject(e)&&delete this._objectsEventsHandlersMap[e],this):(this._objectsEventsHandlersMap={},this)}},{key:"_hasObject",value:function(e){return this._objectsEventsHandlersMap.hasOwnProperty(e)}},{key:"_hasEvent",value:function(e,t){return this._hasObject(e)&&this._objectsEventsHandlersMap[e].hasOwnProperty(t)}}]),e}();t.default=new r},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorType=t.EngineEvents=t.EngineState=t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(3),s=i(u),a=n(1),l=i(a),f=n(5),h=i(f),d=n(4),c=i(d),_=n(0),y=i(_),p=n(6),v=i(p),m={NoAudio:"no-audio",LoadError:"load",PlayError:"play",EngineError:"engine"},b={NotReady:"notready",Ready:"ready",Suspending:"suspending",Suspended:"suspended",Resuming:"resuming",Destroying:"destroying",Done:"done",NoAudio:"no-audio"},g={Add:"add",Remove:"remove",Volume:"volume",Mute:"mute",Pause:"pause",Stop:"stop",Suspend:"suspend",Resume:"resume",Error:"error",Done:"done"},k=function(){function e(){o(this,e),this._id=y.default.id(),this._muted=!1,this._volume=1,this._cleanUpInterval=5,this._intervalId=null,this._isAudioAvailable=!1,this._state=b.NotReady,this._context=null,this._gainNode=null,this._queue=null,this._heap=null,this._loader=null,this._heap=new h.default,this._queue=new c.default}return r(e,[{key:"setup",value:function(e){if(this._state!==b.NotReady)return this;if(this._context=y.default.getContext(),this._isAudioAvailable=Boolean(this._context),!this._isAudioAvailable)return this._state=b.NoAudio,this._fire(g.Error,{type:m.NoAudio,error:"Web Audio API is not available"}),this;var t=e||{},n=t.volume,i=t.muted,o=t.cleanUpInterval,r=t.onadd,u=t.onremove,a=t.onstop,l=t.onpause,f=t.onmute,h=t.onvolume,d=t.onsuspend,c=t.onresume,_=t.onerror,p=t.ondone;return"number"==typeof n&&n>=0&&n<=1&&(this._volume=n),"boolean"==typeof i&&(this._muted=i),"number"==typeof o&&(this._cleanUpInterval=o),"function"==typeof r&&this.on(g.Add,r),"function"==typeof u&&this.on(g.Remove,u),"function"==typeof a&&this.on(g.Stop,a),"function"==typeof l&&this.on(g.Pause,l),"function"==typeof f&&this.on(g.Mute,f),"function"==typeof h&&this.on(g.Volume,h),"function"==typeof d&&this.on(g.Suspend,d),"function"==typeof c&&this.on(g.Resume,c),"function"==typeof _&&this.on(g.Error,_),"function"==typeof p&&this.on(g.Done,p),this._loader=new s.default(this._context),y.default.enableAudio(this._context),this._gainNode=this._context.createGain(),this._gainNode.gain.setValueAtTime(this._muted?0:this._volume,this._context.currentTime),this._gainNode.connect(this._context.destination),this._intervalId=window.setInterval(this._heap.free,60*this._cleanUpInterval*1e3),this._state=b.Ready,this}},{key:"load",value:function(e){return this._loader.load(e)}},{key:"unload",value:function(e){return this._loader.unload(e),this}},{key:"mute",value:function(){return this._muted?this:(this._gainNode.gain.setValueAtTime(0,this._context.currentTime),this._muted=!0,this._fire(g.Mute,this._muted),this)}},{key:"unmute",value:function(){return this._muted?(this._gainNode.gain.setValueAtTime(this._volume,this._context.currentTime),this._muted=!1,this._fire(g.Mute,this._muted),this):this}},{key:"volume",value:function(e){return void 0===e?this._volume:"number"!=typeof e||e<0||e>1?this:(this._gainNode.gain.setValueAtTime(this._muted?0:e,this._context.currentTime),this._volume=e,this._fire(g.Volume,this._volume),this)}},{key:"stop",value:function(){return this._heap.sounds().forEach(function(e){return e.stop()}),this._fire(g.Stop),this}},{key:"suspend",value:function(){var e=this;return this._state===b.Resuming?(this._queue.add("after-resume","suspend",function(){return e.suspend()}),this):this._state!==b.Ready?this:(this.stop(),this._state=b.Suspending,this._context.suspend().then(function(){e._state=b.Suspended,e._queue.run("after-suspend"),e._fire(g.Suspend)}),this)}},{key:"resume",value:function(){var e=this;return this._state===b.Suspending?(this._queue.add("after-suspend","resume",function(){return e.resume()}),this):!this._state!==b.Suspended?this:(this._state=b.Resuming,this._context.resume().then(function(){e._state=b.Ready,e._queue.run("after-resume"),e._fire(g.Resume)}),this)}},{key:"terminate",value:function(){var e=this;if(this._state===b.Done||this._state===b.Destroying)return this;var t=function(){e._intervalId&&window.clearInterval(e._intervalId),e._intervalId=null,e._heap.destroy(),e._heap=null,e._loader&&(e._loader.dispose(),e._loader=null),e._context=null,e._queue.clear(),e._queue=null,e._state=b.Done,e._fire(g.Done),l.default.clear(e._id)};if(this._context){if(this._state===b.Suspending)return this._queue.remove("after-suspend"),this._queue.add("after-suspend","destroy",function(){return e.terminate()}),this;if(this._state===b.Resuming)return this._queue.remove("after-resume"),this._queue.add("after-resume","destroy",function(){return e.terminate()}),this;this._state=b.Destroying,this._context&&this._context.close().then(function(){return t()})}else this._state=b.Destroying,t();return this}},{key:"on",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return l.default.on(this._id,e,t,n),this}},{key:"off",value:function(e,t){return l.default.off(this._id,e,t),this}},{key:"sound",value:function e(t,n,i){if("number"==typeof t)return this._heap.sound(t);var e=new v.default(i);return this._heap.add(t,n,e),e._gain().connect(this._gainNode),e}},{key:"sounds",value:function(e){return this._heap.sounds(e)}},{key:"free",value:function(e,t){return this._heap.free(e,t),this}},{key:"muted",value:function(){return this._muted}},{key:"state",value:function(){return this._state}},{key:"context",value:function(){return this._context}},{key:"isAudioAvailable",value:function(){return this._isAudioAvailable}},{key:"_fire",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return l.default.fire.apply(l.default,[this._id,e].concat(n,[this])),this}}]),e}(),P=new k;t.default=P,t.EngineState=b,t.EngineEvents=g,t.ErrorType=m},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.DownloadStatus=t.DownloadResult=t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(0),s=i(u),a={Success:"success",Failure:"error"},l=function e(t,n,i){o(this,e),this.url=null,this.value=null,this.error=null,this.status=null,this.url=t,this.value=n,this.error=i||null,this.status=i?a.Failure:a.Success},f=function(){function e(t){o(this,e),this._context=null,this._bufferCache={},this._progressCallsAndCallbacks={},this._disposed=!1,this._context=t}return r(e,[{key:"load",value:function(e){var t=this;return"string"==typeof e?this._load(e):Promise.all(e.map(function(e){return t._load(e)}))}},{key:"unload",value:function(e){var t=this;return"string"==typeof e?void this._unload(e):Array.isArray(e)?void e.forEach(function(e){return t._unload(e)},this):void(this._bufferCache={})}},{key:"dispose",value:function(){this._disposed||(this.unload(),this._bufferCache={},this._progressCallsAndCallbacks=null,this._context=null,this._disposed=!0)}},{key:"_load",value:function(e){var t=this;return new Promise(function(n){if(t._bufferCache.hasOwnProperty(e))return void n(new l(e,t._bufferCache[e]));if(t._progressCallsAndCallbacks.hasOwnProperty(e))return void t._progressCallsAndCallbacks[e].push(n);t._progressCallsAndCallbacks[e]=[],t._progressCallsAndCallbacks[e].push(n);var i=function(n){t._disposed||(t._progressCallsAndCallbacks[e].forEach(function(t){return t(new l(e,null,n))}),delete t._progressCallsAndCallbacks[e])},o=function(n){t._disposed||t._context.decodeAudioData(n,function(n){t._bufferCache[e]=n,t._progressCallsAndCallbacks[e].forEach(function(t){return t(new l(e,n))}),delete t._progressCallsAndCallbacks[e]},i)};if(s.default.isBase64(e)){for(var r=atob(e.split(",")[1]),u=new Uint8Array(r.length),a=0;a<r.length;++a)u[a]=r.charCodeAt(a);return void o(u)}var f=new XMLHttpRequest;f.open("GET",e,!0),f.responseType="arraybuffer",f.addEventListener("load",function(){return o(f.response)},!1),f.addEventListener("error",i,!1),f.send()})}},{key:"_unload",value:function(e){delete this._bufferCache[e]}}]),e}();t.default=f,t.DownloadResult=l,t.DownloadStatus=a},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(){i(this,e),this._eventActions={}}return o(e,[{key:"add",value:function(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.hasEvent(e)||(this._eventActions[e]={}),this._eventActions[e][t]={fn:n,removeAfterRun:i}}},{key:"hasEvent",value:function(e){return this._eventActions.hasOwnProperty(e)}},{key:"hasAction",value:function(e,t){return!!this.hasEvent(e)&&this._eventActions[e].hasOwnProperty(t)}},{key:"run",value:function(e,t){var n=this;if(this.hasEvent(e)){if("undefined"!=typeof t){if(!this.hasAction(e,t))return;return void this._run(e,t)}Object.keys(this._eventActions[e]).forEach(function(t){return n._run(e,t)})}}},{key:"remove",value:function(e,t){if(this._eventActions.hasOwnProperty(e))return t?void delete this._eventActions[e][t]:void delete this._eventActions[e]}},{key:"clear",value:function(){this._eventActions={}}},{key:"_run",value:function(e,t){var n=this._eventActions[e][t];n.fn(),n.removeAfterRun&&this.remove(e,t)}}]),e}();t.default=r},function(e,t,n){"use strict";function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=function e(t,n){o(this,e),this.sound=null,this.groupId=null,this.groupId=t,this.sound=n},s=function(){function e(){o(this,e),this.url=null,this.items={}}return r(e,[{key:"add",value:function(e,t){var n=t.id().toString();this.items.hasOwnProperty(n)||(this.items[n]=new u(e,t))}},{key:"free",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments[1];Object.values(this.items).forEach(function(i){var o=i.sound,r=i.soundGroupId;t&&(o.isPlaying()||o.isPaused())||Boolean(n)&&r!==n||(o.destroy(),delete e.items[o.id()])})}},{key:"sounds",value:function(e){var t=Object.values(this.items),n=e?t.filter(function(t){return t.groupId===e}):t;return n.map(function(e){return e.sound})}},{key:"destroy",value:function(){Object.values(this.items).forEach(function(e){return e.sound.destroy()}),this.items={}}}]),e}(),a=function(){function e(){o(this,e),this._collections={},this.free=this.free.bind(this)}return r(e,[{key:"add",value:function(e,t,n){this._collections.hasOwnProperty(e)||(this._collections[e]=new s),this._collections[e].add(t,n)}},{key:"sound",value:function(e){return this.sounds().find(function(t){return t.id()===e})}},{key:"sounds",value:function e(t){var e=[];return Object.values(this._collections).forEach(function(n){return e.push.apply(e,i(n.sounds(t)))}),e}},{key:"free",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments[1];Object.values(this._collections).forEach(function(n){return n.free(e,t)})}},{key:"destroy",value:function(){Object.values(this._collections).forEach(function(e){return e.destroy()}),this._collections={}}}]),e}();t.default=a},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.SoundState=t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(2),s=i(u),a=n(0),l=i(a),f={Ready:"ready",Playing:"playing",Paused:"paused",Destroyed:"destroyed"},h=function(){function e(t){o(this,e),this._id=-1,this._volume=1,this._rate=1,this._muted=!1,this._loop=!1,this._state=f.Ready,this._context=null,this._gainNode=null,this._buffer=null,this._bufferSourceNode=null,this._duration=0,this._startPos=0,this._endPos=0,this._currentPos=0,this._rateSeek=0,this._startTime=0,this._playEndCallback=null,this._destroyCallback=null;var n=t.id,i=t.buffer,r=t.volume,u=t.rate,a=t.loop,h=t.muted,d=t.startPos,c=t.endPos,_=t.playEndCallback,y=t.destroyCallback;this._id="number"==typeof n?n:l.default.id(),this._buffer=i,this._endPos=this._buffer.duration,r&&(this._volume=r),u&&(this._rate=u),h&&(this._muted=h),a&&(this._loop=a),d&&(this._startPos=d),c&&(this._endPos=c),this._playEndCallback=_,this._destroyCallback=y,this._duration=this._endPos-this._startPos,this._context=s.default.context(),this._gainNode=this._context.createGain(),this._gainNode.gain.setValueAtTime(this._muted?0:this._volume,this._context.currentTime)}return r(e,[{key:"play",value:function(){var e=this;if(this.isPlaying())return this;var t=Math.max(0,this._currentPos>0?this._currentPos:this._startPos);this._bufferSourceNode=this._context.createBufferSource(),this._bufferSourceNode.buffer=this._buffer,this._bufferSourceNode.playbackRate.setValueAtTime(this._rate,this._context.currentTime),this._setLoop(this._loop),this._bufferSourceNode.connect(this._gainNode),this._bufferSourceNode.addEventListener("ended",function(){e._currentPos=0,e._rateSeek=0,e._destroyBufferNode(),e._state=f.Ready,e._playEndCallback&&e._playEndCallback(e)});var n=this._context.currentTime;return"undefined"!=typeof this._bufferSourceNode.start?this._bufferSourceNode.start(n,t,this._loop?void 0:this._duration):this._bufferSourceNode.noteGrainOn(n,t,this._loop?void 0:this._duration),this._startTime=n,this._state=f.Playing,this}},{key:"pause",value:function(){return this.isPlaying()?(this._currentPos=this.seek(),this._rateSeek=0,this._destroyBufferNode(),this._state=f.Paused,this):this}},{key:"stop",value:function(){return this.isPlaying()||this.isPaused()?(this._currentPos=0,this._rateSeek=0,this._destroyBufferNode(),this._state=f.Ready,this):this}},{key:"mute",value:function(){return this._gainNode.gain.setValueAtTime(0,this._context.currentTime),this._muted=!0,this}},{key:"unmute",value:function(){return this._gainNode.gain.setValueAtTime(this._volume,this._context.currentTime),this._muted=!1,this}},{key:"volume",value:function(e){return"undefined"==typeof e?this._volume:(this._gainNode.gain.setValueAtTime(this._muted?0:e,this._context.currentTime),this._volume=e,this)}},{key:"rate",value:function(e){return"undefined"==typeof e?this._rate:(this._rate=e,this._rateSeek=this.seek(),this.isPlaying()&&(this._startTime=this._context.currentTime,this._bufferSourceNode&&this._bufferSourceNode.playbackRate.setValueAtTime(e,this._context.currentTime)),this)}},{key:"seek",value:function(e){if("undefined"==typeof e){var t=this.isPlaying()?this._context.currentTime-this._startTime:0,n=this._rateSeek?this._rateSeek-this._currentPos:0;return this._currentPos+(n+t*this._rate)}if(e<this._startPos||e>this._endPos)return this;var i=this.isPlaying();return i&&this.pause(),this._currentPos=e,i&&this.play(),this}},{key:"loop",value:function(e){return"boolean"!=typeof e?this._loop:(this._loop=e,this._setLoop(e),this)}},{key:"destroy",value:function(){return this._state===f.Destroyed?this:(this.stop(),this._gainNode.disconnect(),this._buffer=null,this._context=null,this._gainNode=null,this._state=f.Destroyed,this._destroyCallback&&this._destroyCallback(this),this)}},{key:"id",value:function(){return this._id}},{key:"muted",value:function(){return this._muted}},{key:"state",value:function(){return this._state}},{key:"duration",value:function(){return this._duration}},{key:"isPlaying",value:function(){return this._state===f.Playing}},{key:"isPaused",value:function(){return this._state===f.Paused}},{key:"_gain",value:function(){return this._gainNode}},{key:"_destroyBufferNode",value:function(){this._bufferSourceNode&&("undefined"!=typeof this._bufferSourceNode.stop?this._bufferSourceNode.stop():this._bufferSourceNode.noteGrainOff(),this._bufferSourceNode.disconnect(),this._bufferSourceNode.removeEventListener("ended",this._onEnded),this._bufferSourceNode=null)}},{key:"_setLoop",value:function(e){this._bufferSourceNode&&(this._bufferSourceNode.loop=e,e&&(this._bufferSourceNode.loopStart=this._startPos,this._bufferSourceNode.loopEnd=this._endPos))}}]),e}();t.default=h,t.SoundState=f},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(2),a=i(s),l=n(4),f=i(l),h=n(0),d=i(h),c=n(1),_=i(c),y=n(3),p={Ready:"ready",Destroyed:"destroyed"},v={Load:"load",UnLoad:"unload",PlayStart:"playstart",PlayEnd:"playend",Pause:"pause",Stop:"stop",Volume:"volume",Mute:"mute",Seek:"seek",Rate:"rate",Error:"error",Destroy:"destroy"},m={NotLoaded:"notloaded",Loading:"loading",Loaded:"loaded"},b=function(){function e(t){if(o(this,e),this._id=-1,this._src=null,this._format=[],this._sprite=null,this._volume=1,this._rate=1,this._muted=!1,this._loop=!1,this._preload=!1,this._autoplay=!1,this._buffer=null,this._duration=0,this._compatibleSrc=null,this._loadState=m.NotLoaded,this._state=p.Ready,this._queue=null,this._engine=null,this._engine=a.default,this._engine.setup(),!this._engine.isAudioAvailable())return this._fire(v.Error,null,{type:s.ErrorType.NoAudio,error:"Web Audio is un-available"}),this;if("string"==typeof t)this._src=[t];else if(Array.isArray(t)&&t.length)this._src=t;else if("object"===("undefined"==typeof t?"undefined":r(t))){var n=t.id,i=t.src,u=t.format,l=t.sprite,h=t.volume,c=t.rate,_=t.muted,y=t.loop,b=t.autoplay,g=t.preload,k=t.onload,P=t.onunload,S=t.onplaystart,A=t.onplayend,E=t.onstop,w=t.onpause,x=t.onmute,T=t.onvolume,C=t.onrate,N=t.onseek,O=t.onerror,j=t.ondestroy;this._id="number"==typeof n?n:d.default.id(),"string"==typeof i?this._src=[i]:Array.isArray(i)&&i.length&&(this._src=i),Array.isArray(u)?this._format=u:"string"==typeof u&&u&&(this._format=[u]),"object"===("undefined"==typeof l?"undefined":r(l))&&(this._sprite=l),"number"==typeof h&&h>=0&&h<=1&&(this._volume=h),"number"==typeof c&&c>=.5&&c<=5&&(this._rate=c),"boolean"==typeof _&&(this._muted=_),"boolean"==typeof y&&(this._loop=y),"boolean"==typeof b&&(this._autoplay=b),"boolean"==typeof g&&(this._preload=g),"function"==typeof k&&this.on(v.Load,k),"function"==typeof P&&this.on(v.UnLoad,P),"function"==typeof S&&this.on(v.PlayStart,S),"function"==typeof A&&this.on(v.PlayEnd,A),"function"==typeof E&&this.on(v.Stop,E),"function"==typeof w&&this.on(v.Pause,w),"function"==typeof x&&this.on(v.Mute,x),"function"==typeof T&&this.on(v.Volume,T),"function"==typeof C&&this.on(v.Rate,C),"function"==typeof N&&this.on(v.Seek,N),"function"==typeof O&&this.on(v.Error,O),"function"==typeof j&&this.on(v.Destroy,j)}if(!this._src)throw new Error("You should pass the source for the audio.");this._queue=new f.default,this._autoplay?this.play():this._preload&&this.load()}return u(e,[{key:"load",value:function(){var e=this;if(this.isLoaded()||this._loadState===m.Loading)return this;this._loadState=m.Loading;var t=this._compatibleSrc||(this._compatibleSrc=this.getCompatibleSource());return t?(this._engine.load(t).then(function(t){if(e._loadState!==m.NotLoaded&&e._state!==p.Destroyed)return t.status===y.DownloadStatus.Success?(e._buffer=t.value,e._duration=e._buffer.duration,e._loadState=m.Loaded,e._fire(v.Load,null,t),void e._queue.run("after-load")):void e._onLoadFailure(t.error)}),this):(this._onLoadFailure("The audio formats you passed are not supported"),this)}},{key:"_onLoadFailure",value:function(e){this._queue.remove("after-load"),this._loadState=m.NotLoaded,this._fire(v.Error,null,{type:s.ErrorType.LoadError,error:e})}},{key:"getCompatibleSource",value:function(){return this._format.length?this._src[this._format.indexOf(d.default.getSupportedFormat(this._format))]:d.default.getSupportedSource(this._src)}},{key:"play",value:function(e){var t=this,n="number"==typeof e;if(n){var i=this._engine.sound(e);return i&&(i.play(),this._fire(v.PlayStart,e)),this}var o=d.default.id(),r=function(){var n={id:o,buffer:t._buffer,volume:t._volume,rate:t._rate,muted:t._muted,loop:t._loop,playEndCallback:function(e){return t._fire(v.PlayEnd,e.id())},destroyCallback:function(e){t._fire(v.Destroy,e.id()),_.default.clear(e.id())}};if("string"==typeof e&&t._sprite&&t._sprite.hasOwnProperty(e)){var i=t._sprite[e];n.startPos=i[0],n.endPos=i[1]}var r=t._engine.sound(t._compatibleSrc,t._id,n);r.play(),t._fire(v.PlayStart,r.id())};return this.isLoaded()?r():(this._queue.add("after-load","play-"+o,function(){return r()}),this.load()),o}},{key:"pause",value:function(e){return this._queue.remove("after-load",e?"play-"+e:null),this._sounds(e).forEach(function(e){return e.pause()}),this._fire(v.Pause,e),this}},{key:"stop",value:function(e){return this._queue.remove("after-load",e?"play-"+e:null),this._sounds(e).forEach(function(e){return e.stop()}),this._fire(v.Stop,e),this}},{key:"mute",value:function(e){return this._sounds(e).forEach(function(e){return e.mute()}),"number"!=typeof e&&(this._muted=!0),this._fire(v.Mute,e,this._muted),this}},{key:"unmute",value:function(e){return this._sounds(e).forEach(function(e){return e.unmute()}),"number"!=typeof e&&(this._muted=!1),this._fire(v.Mute,e,this._muted),this}},{key:"volume",value:function(e,t){if("number"==typeof e&&e>=0&&e<=1)return this._sounds(t).forEach(function(t){return t.volume(e)}),"number"!=typeof t&&(this._volume=e),this._fire(v.Volume,t,this._volume),this;if("number"==typeof t){var n=this._engine.sound(t);return n?n.volume():null}return this._volume}},{key:"rate",value:function(e,t){if("number"==typeof e&&e>=.5&&e<=5)return this._sounds(t).forEach(function(t){return t.rate(e)}),"number"!=typeof t&&(this._rate=e),this._fire(v.Rate,t,this._rate),this;if("number"==typeof t){var n=this._engine.sound(t);return n?n.rate():null}return this._rate}},{key:"seek",value:function(e,t){var n=this,i=this._engine.sound(e);return i?"number"==typeof t?this.isLoaded()?(i.seek(t),this._fire(v.Seek,e,t),this):(this._queue.add("after-load","seek-"+e,function(){return n.seek(e,t)}),this.load(),this):i.seek():this}},{key:"loop",value:function(e,t){if("boolean"==typeof e)return this._sounds(t).forEach(function(t){return t.loop(e)}),"number"!=typeof t&&(this._loop=e),this;if("number"==typeof t){var n=this._engine.sound(t);return n?n.loop():null}return this._loop}},{key:"playing",value:function(e){var t=this._engine.sound(e);return t?t.isPlaying():null}},{key:"muted",value:function(e){if("number"==typeof e){var t=this._engine.sound(e);return t?t.muted():null}return this._muted}},{key:"state",value:function(e){if("number"==typeof e){var t=this._engine.sound(e);return t?t.state():null}return this._state}},{key:"duration",value:function(e){if("number"==typeof e){var t=this._engine.sound(e);return t?t.duration():null}return this._duration}},{key:"unload",value:function(){return this._queue.remove("after-load"),this._engine.unload(this._compatibleSrc),this._buffer=null,this._duration=0,this._loadState=m.NotLoaded,this}},{key:"destroy",value:function(){return this._state===p.Destroyed?this:(this.stop(),this._queue.clear(),this._engine.free(!1,this._id),this._buffer=null,this._queue=null,this._engine=null,this._state=p.Destroyed,this._fire(v.Destroy),void _.default.clear(this._id))}},{key:"on",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments[3];return _.default.on(i||this._id,e,t,n),this}},{key:"off",value:function(e,t,n){return _.default.off(n||this._id,e,t),this}},{key:"id",value:function(){return this._id}},{key:"loadState",value:function(){return this._loadState}},{key:"isLoaded",value:function(){return this._loadState===m.Loaded}},{key:"sound",value:function(e){return this._engine.sound(e)}},{key:"alive",value:function(e){return Boolean(this.sound(e))}},{key:"_sounds",value:function(e){if("number"==typeof e){var t=this._engine.sound(e);return t?[t]:[]}return this._engine.sounds(this._id)}},{key:"_fire",value:function(e,t){for(var n=arguments.length,i=Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];return t?_.default.fire.apply(_.default,[t,e].concat(i,[this.sound(t),this])):_.default.fire.apply(_.default,[this._id,e].concat(i,[this])),this}}]),e}(),g=function(e){return new b(e)};["setup","load","unload","mute","unmute","volume","stop","suspend","resume","terminate","muted","state","context","isAudioAvailable","on","off"].forEach(function(e){g[e]=function(){var t=a.default[e].apply(a.default,arguments);return t===a.default?g:t}}),e.exports=g}])});
//# sourceMappingURL=musquito-1.0.2.min.js.map